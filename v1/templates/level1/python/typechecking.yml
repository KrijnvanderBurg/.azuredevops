# Level 1 template for Python type checking
# Combines multiple Level 0 type checking templates (mypy, pyre, pyright)

parameters:
  - name: enabled
    type: boolean
    default: true
    
  - name: continueOnError
    type: boolean
    default: true  # Type checking failures should typically not break the build
    
  - name: pythonSrcDirectory
    type: string
    default: $(Build.SourcesDirectory)
    
  - name: pythonSourceDirectories
    type: string
    default: "src tests"

steps:
  - template: ../../level0/python/mypy_typechecker.yml
    parameters:
      pythonSrcDirectory: ${{ parameters.pythonSrcDirectory }}
      pythonSourceDirectories: ${{ parameters.pythonSourceDirectories }}
      continueOnError: ${{ parameters.continueOnError }}
      enabled: ${{ parameters.enabled }}

  - template: ../../level0/python/pyre_typechecker.yml
    parameters:
      pythonSrcDirectory: ${{ parameters.pythonSrcDirectory }}
      pythonSourceDirectories: ${{ parameters.pythonSourceDirectories }}
      continueOnError: ${{ parameters.continueOnError }}
      enabled: ${{ parameters.enabled }}

  - template: ../../level0/python/pyright_typechecker.yml
    parameters:
      pythonSrcDirectory: ${{ parameters.pythonSrcDirectory }}
      pythonSourceDirectories: ${{ parameters.pythonSourceDirectories }}
      continueOnError: ${{ parameters.continueOnError }}
      enabled: ${{ parameters.enabled }}
      
  - script: |
      echo "##[section]Type checking complete"
    displayName: 'Type checking summary'
    condition: and(succeeded(), eq('${{ parameters.enabled }}', 'true'))
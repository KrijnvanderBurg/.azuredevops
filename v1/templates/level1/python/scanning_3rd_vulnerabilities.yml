# Level 1 template for scanning third-party dependencies for vulnerabilities
# Combines multiple Level 0 dependency scanning templates

parameters:
  - name: enabled
    type: boolean
    default: true
    
  - name: continueOnError
    type: boolean
    default: true  # Security issues should be reported but not break the build by default
    
  - name: pythonSrcDirectory
    type: string
    default: $(Build.SourcesDirectory)

steps:
  - template: ../../level0/python/ossaudit_scanner.yml
    parameters:
      pythonSrcDirectory: ${{ parameters.pythonSrcDirectory }}
      continueOnError: ${{ parameters.continueOnError }}
      enabled: ${{ parameters.enabled }}

  - template: ../../level0/python/owasp_scanner.yml
    parameters:
      pythonSrcDirectory: ${{ parameters.pythonSrcDirectory }}
      continueOnError: ${{ parameters.continueOnError }}
      enabled: ${{ parameters.enabled }}
      
  - script: |
      echo "##[section]Third-party dependency security scanning complete"
    displayName: 'Dependency scanning summary'
    condition: and(succeeded(), eq('${{ parameters.enabled }}', 'true'))